---
title: "Untitled"
author: "Юрченков Иван Александрович"
date: "13 01 2022"
output: 
  word_document: 
    highlight: haddock
    fig_width: 9
    fig_height: 9
    fig_caption: yes
    keep_md: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Введение

Данная работа посвящена исследованию возможности построения алгоритма автоматического выявления паттернов медленного движения временного ряда (тренда) на основе линеаризуемых основных моделей динамики природных систем, реализующихся в виде дифференциальных уравнений. Среди таких моделей чаще всего употребимы в классических научных трудах: модели интенсивного роста на основе изменения темпов роста, модели ограниченного роста на основе лимитированной энергии развития системы, комплексные модели динамики систем.

Проблема изучения и выявления характеристик временного ряда данных является классической. В общей постановке, единообразного математического подхода исследования временных рядов с возможностью дальнейшего прогнозирования и верификации наблюдений нет и по сей день. Каждая динамическая система изучается в отдельности и к каждой динамической системе необходим уникальный подход. Однако, на текущий момент существует большое количество общих рекомендаций и решений, которые способствуют выработке правильных выводов о характере динамики и поведении системы как на уровне быстрых движений вокруг общей тенденции, так и на трендовом уровне. Системы таких рекомендаций и решений являются довольно мощными инструментами в вопросах исследования временных рядов и их свойств. Среди таких методов существуют следующие: алгоритм преобразования Фурье, STL-декомпозиция временного ряда, анализ распределений, структурная функция Колмогорова и функция Альтера-Джонсона, корреляционные и автокорреляционные функции.   
Проблематика данной работы была естественным образом поставлена в момент разработки алгоритма выявления почти-периодических компонент динамических систем на основе обобщенной сдвиговой функции Альтера-Джонсона и алгоритма выявления почти пропорций. 

Практическая значимость работы состоит в обогащении коллекции алгоритмов выявления значимых характеристик временного ряда данных новым алгоритмом, позволяющим на основе определенных метрик выявить наиболее закономерные участки медленных движений временного ряда данных, отвечающих природным динамическим моделям развития систем. 


## Теоретическая часть

### Временные ряды

Временной ряд - собранные в разные моменты времени значения показателей наблюдаемой системы или исследуемого процесса. Каждое измеренное значение системы называется измерением или отсчётом. Во временном ряде для каждого отсчёта должно быть указано время измерения и (или) номер измерения по порядку следования. 

Временной ряд является более сложным понятием в науке о данных по сравнению с понятием *статистической выборки*. Если в статистике статистическая выборка это набор независимых случайно выбранных наблюдений, характеризующих систему в целом, то в понятии *временной ряд* фигурируют такие понятия как зависимость наблюдений друг от друга, зависимость наблюдений от времени и следования. Все эти факторы необходимо учитывать при построении моделей или при анализе данных такого рода.



Временные ряды в простой классификации бывают *равномерные* и *неравномерные* и различаются характером снятия измерений с динамической системы.

### Равномерный временной ряд

Равномерный временной ряд - ряд данных, измерения или отсчёты в котором производятся через равные интервалы времени, т.е. записываются в таблицу с определенной заранее заданной частотой. Система математически записывается следующим образом:

$$
t_i = t_0 + i * \Delta t, \ \ \ t_0 = const, \ \ \ \Delta t = const, \ \ \ i = 0, \dots, N;
$$

$$
\varphi^j(t_i) = \varphi_i^j, \ \ \ j = 1, \dots, M,
$$
где $t_0$ - начальный момент времени или время зарождения процесса; $\Delta t$ - период времени, через который производятся измерения числовых показателей изучаемой системы; $N$ - текущий отсчет, соответствующий настоящему моменту времени или отсчет, соответствующий моменту времени завершения процесса в прошлом; $M$ - количество снимаемых динамических показателей из системы $\varphi$; $\varphi^j$ - динамический показатель системы, измеряемый во времени.

```{r periodic time series, dpi=256, echo=FALSE}
set.seed(123)
PTS <- data.frame(time = 0:16, data = rnorm(17, 0, 1) + 0.6 * (0:16) - 0.02 * (0:16)^2)

plot(PTS, xaxt = "n", type = "o", pch = 19, cex = I(1.2),
     main = "Равномерный временной ряд",
     xlab = "Время, ti",
     ylab = "Значения измерений")
axis(1, at = 0:16, labels = paste0("t", 0:16))
abline(h = seq(-2, 8, 1), col = "grey2", lwd = I(0.5), lty = 2)
abline(v = seq(0, 16, 1), col = "grey2", lwd = I(0.5), lty = 2)
```


Таким образом определяется равномерный временной ряд $\varphi^j$ наблюдаемой системы $\varphi$. 

Зачастую равномерные временные ряды это ряды с относительно небольшим возрастом, так как исторические данные в силу технического развития не могли быть сняты через одинаковые довольно короткие промежутки времени. В настоящий момент можно встретить временные ряды с частотой дискретизации наблюдений порядка десяток тысяч наблюдений в секунду.


### Тренд



### Сезонность



### Ошибки



### Модели интенсивного роста



### Модели ограниченного роста



### Анализ сезонности на основе функции Альтера-Джонсона

Для выявления периодов, свободных по возможности от априорных предположений, используем подход, который опирается, прежде всего, на фундаментальное характеристическое свойство периода функции, состоящее в повторении значений функции через интервал изменения независимой переменной равный периоду

$$
f(t + \tau) - f(t) = 0
$$

Вводится следующее определение почти–периодической функции: число $\tau$ называется $\varepsilon$ – почти–периодом ($\varepsilon$ – смещением) функции $f(t)$ $(-\infty < t < \infty)$, если для всех $t$ выполняется неравенство

$$
|f(t + \tau) - f(t)| < \varepsilon
$$


Если $f(t)$ – периодическая функция и $\tau$ – ее период, то есть $f(t+\tau) = f(t)$, то, очевидно, $\tau$ является также и почти–периодом для любого $\varepsilon>0$, точно так же, как и любое число вида $n \tau$ $(n= \pm 1, \pm 2, …)$.

Для дискретного случая, если $n$ - общее число отсчетов функции $f(t)$, заданной экспериментальными значениями, вводится следующая метрика для определения почти периодов:

$$
a(\tau) = \frac{1}{N} \sum_{t = 0}^{N - \tau - 1} ||f(t + \tau) - f(t)||_p 
$$

Эта функция называется сдвиговой или функцией Альтера-Джонса.

Система почти - периодов $τ$ функции $f(t)$ может быть определена как совокупность локальных минимумов сдвиговой функции

$$
\tau = argmin[a(\tau)], \ \ \ \tau_{min} < \tau < \tau_{max}
$$

Функция Альтера–Джонса определяет среднее расстояние по оси ординат между точками, расположенными на расстоянии $τ$ по оси абсцисс друг от друга.

### Обобщенная сдвиговая функция

$$
a(\tau, \Delta t) = \frac{1}{N} \sum_{t = 0}^{N - \tau - 1} ||f(t + \tau) - f(t)||_p 
$$

### Анализ почти-пропорций

### Автокорреляционная фукнция

Автокорреляционная функция — зависимость взаимосвязи между функцией (сигналом) и её сдвинутой копией от величины временного сдвига [1]. Для детерминированных сигналов автокорреляционная функция (АКФ) сигнала $f(t)$ определяется интегралом:

$$
\varPsi(\tau)=\int_{-\infty}^{\infty} f(t) f^{*}(t - \tau) dt
$$

и показывает связь сигнала (функции f(t)) с копией самого себя, смещённого на величину τ . Звёздочка означает комплексное сопряжение.

### Линейная регрессия

Задача линейной регрессии состоит в восстановлении линейной зависимости

$$
\hat{y}(w, t_i) = w_0 + w_1 \cdot t_i
$$

относительно исходных данных, минимизируя квадрат ошибок между значениями модели и значениями исходного ряда данных по набору параметров $w$

$$
|| y - \hat{y}(w)||_2^2 \rightarrow min_w.
$$

Данная задача разрешается с помощью линейной алгебры в следующем соотношении:

$$
w = (X^T X)^{-1} X^T y.
$$

### Коэффициент детерминации




## Основная часть

В основе исследования трендовой зависимости исследуемой динамической системы лежит возможность установления естественных зависимостей в виде моделей дифференциальных уравнений, поскольку именно модели дифференциальных уравнений являются фундаментальными природными моделями развития систем. В связи с этими соображениями появилась идея разработки алгоритма обобщенного исследования временного ряда динамической системы на наличие линеризуемых дифференциальных моделей таких как модели интенсивного и ограниченного роста.

В основе разрабатываемого алгоритма лежит идея линеаризуемости некоторых видов одномерны дифференциальных моделей развития системы или показателя во времени. Такого рода линеаризация производится за счет функционального преобразования координат, которая в линеаризуемых участках ряда идентифицирует одномерную дифференциальную модель.

Существует ряд проблем, которые всё же являются непреодолимыми при разработке такого рода "автоматических" алгоритмов:

 1. Невозможно для абсолютно всех классов динамических систем построить общую стройную теорию автоматического исследования характеристик ряда ввиду сложности природных явлений, которые ключевым образом влияют на поведение физических и даже экономических систем.
 2. Невозможно адекватно и за приемлемое время работать с длинными и достаточно плотными временными рядами ввиду шума измерительных приборов, числа операций для обработки и т.д.
 3. Сложность разработки быстрых эффективных алгоритмов.
 

### Наивный алгоритм или обобщенный алгоритм выявления трендовых участков

Общий алгоритм исследования временного ряда с использованием обобщенного алгоритма характеризации тренда:

 1. Полученный временной ряд предварительно очистить от шума.
 2. Изучить быстрые движения относительно тренда на наличие тонких колебательных зависимостей, являющихся сезонными, во избежание нежелательного искажения действительности в трендовых характеристиках.
 3. Идентификация почти-периодических зависимостей на основе обобщенной сдвиговой функции Альтера-Джонсона или структурной функции Колмогорова.
 4. Выделение тренда на основе сглаживания временного ряда по идентифицированному почти-периодическому значению.
 5. Применение алгоритма обобщенного исследования характеристики тренда.
 6. Получение метрики уверенности в наличии дифференциальной модели на конкретных участках временного ряда исследуемой динамической системы.

Алгоритм обобщенного исследования характеристики тренда:

 - 1.  

Метрика по которой мы можем судить о достаточном спрямлении данных в аллометрических координатах - *коэффициент детерминации*. Таким образом 


$$

$$

![pic1](/Users/MariaRemark/Rprojects/auto_trend_disc/MarkdownR/pics/цены ATVI log.png)


![pic2](/Users/MariaRemark/Rprojects/auto_trend_disc/MarkdownR/pics/Alter-Johns.png)


![pic3](/Users/MariaRemark/Rprojects/auto_trend_disc/MarkdownR/pics/smoothed.png)


![pic4](/Users/MariaRemark/Rprojects/auto_trend_disc/MarkdownR/pics/1.png)

![pic5](/Users/MariaRemark/Rprojects/auto_trend_disc/MarkdownR/pics/2.png)



![pic6](/Users/MariaRemark/Rprojects/auto_trend_disc/MarkdownR/pics/3.png)


![pic7](/Users/MariaRemark/Rprojects/auto_trend_disc/MarkdownR/pics/3.png)


![pic8](/Users/MariaRemark/Rprojects/auto_trend_disc/MarkdownR/pics/4.png)



![pic9](/Users/MariaRemark/Rprojects/auto_trend_disc/MarkdownR/pics/5.png)



![pic10](/Users/MariaRemark/Rprojects/auto_trend_disc/MarkdownR/pics/6.png)


![pic11](/Users/MariaRemark/Rprojects/auto_trend_disc/MarkdownR/pics/7.png)


![pic12](/Users/MariaRemark/Rprojects/auto_trend_disc/MarkdownR/pics/8.png)


### Эффективный алгоритм выявления трендовых участков

## Заключение

## Список использованной литературы


 1.	Charles Therrien, Murali Tummala. Probability and Random Processes for Electrical and Computer Engineers. — CRC Press, 2012. — P. 287
 2.	Verhulst, P. F., (1838). Notice sur la loi que la population poursuit dans son accroissement. Correspondance mathématique et physique, 10, 113—121.
 3.	Verhulst, P. F., Recherches Mathématiques sur La Loi D’Accroissement de la Population, Nouveaux Mémoires de l’Académie Royale des Sciences et Belles-Lettres de Bruxelles, 18, Art. 1, 1—45, 1845 (Mathematical Researches into the Law of Population Growth Increase).
 4.	Pearl, Raymond. The Biology of Population Growth (англ.) // The American Mercury. — 1924. — Ноябрь (т. III, № 11). — С. 293– 305.
 5.	Pearl, Raymond and Lowell J. Reed. On the Rate of Growth of the Population of the United States since 1790 and its Mathematical Representation (англ.) // Proceedings of the National Academy of Sciences of the United States of America (PNAS; USA). — 1920. — 15 июня (т. 6, № 6). — С. 275–288.
 6.	Gompertz, B. “On the Nature of the Function Expressive of the Law of Human Mortality, and on a New Mode of Determining the Value of Life Contingencies.” Phil. Trans. Roy. Soc. London 123, 513-585, 1832.
 7.	Hofbauer, Josef; Sigmund, Karl (1998). “Dynamical Systems and Lotka–Volterra Equations”. Evolutionary Games and Population Dynamics. New York: Cambridge University Press. pp. 1–54. ISBN 0-521-62570-X.
 8.	Кузьмин В.И., Гадзаов А.Ф. Методы построения моделей по эмпирическим данным: Учебное пособие / Московский государственный институт радиотехники, электроники и автоматики (технический университет) – М., 2012. – 94 с.
 9.	Кузьмин В.И., Гадзаов А.Ф. Прикладные задачи математической статистики: Учебное пособие / Московский государственный институт радиотехники, электроники и автоматики (технический университет) – М., 2011. – 92 с.
 10.	Модели и методы определения параметров нелинейных процессов [Электронный ресурс]: монография / В. И. Кузьмин [и др.]. — М.: МИРЭА, 2016. — 148 с.. — Электрон. опт. диск (ISO) ISBN 978-5-600-01609-5
 11.	Модели и алгоритмы анализа нелинейных колебаний с трендом [Электронный ресурс]: монография / В. И. Кузьмин [и др.]. — М.: МИРЭА, 2015. — 94 с.. — Электрон. опт. диск (ISO) ISBN 978-5-7339-1109-9
 12.	Методы анализа данных [Электронный ресурс]: учебное пособие / В. И. Кузьмин, А. Ф. Гадзаов. — М.: РТУ МИРЭА, 2020. — Электрон. опт. диск (ISO)
